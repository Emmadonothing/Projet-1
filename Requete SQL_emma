--------Stock Flop 5 =


SELECT 
    productCode,
    productName,
    quantityInStock
FROM 
    products
ORDER BY 
    quantityInStock ASC
LIMIT 5;


-------Stock Top 5 = 

SELECT
  productCode,
  productName,
  quantityInStock
FROM
  products
ORDER BY
  quantityInStock DESC
LIMIT
  5;

-- Correction Imad stock top 5 =

SELECT
  products.productCode,
  productName,
  quantityInStock,
  SUM(quantityOrdered) AS Qte_commande
FROM
  products
JOIN 
orderdetails ON orderdetails.productCode = products.productCode
GROUP BY products.productCode
ORDER BY
  Qte_commande DESC
LIMIT
  5;

------Marge Potentielle = 
SELECT 
    p.productCode,
    p.productName,
    SUM(od.quantityOrdered) AS totalQuantity,
    p.MSRP,
    p.buyPrice,
    (SUM(od.quantityOrdered) * p.MSRP) - (SUM(od.quantityOrdered) * p.buyPrice) AS potentialMargin
FROM 
    products p
JOIN 
    orderdetails od ON p.productCode = od.productCode
GROUP BY 
    p.productCode, p.productName, p.MSRP, p.buyPrice
ORDER BY 
    potentialMargin DESC;




